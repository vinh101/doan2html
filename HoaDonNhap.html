<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./css/admin.css">
    <link rel="stylesheet" href="./viyeu/fontawesome-free-6.4.2-web/fontawesome/css/all.min.css">
    <script src="./js/jquery-3.6.0.min.js"></script>
    <script src="./js/main.js"></script>
    <title>Quản lý cửa hàng bán Đồng hồ</title>
</head>

<body>
    <section class="header">
        <a href="javascript:void(0);" class="icon" onclick="openBTN()">
            <i class="fas fa-bars"></i>
        </a>
        <div class="box-login" id="box-t">
            Xin chào, <span id="ten_nv">Admin</span> <i class="fas fa-sort-down"></i>
            <div class="box-login-bottom" id="box-b">
                <button onclick="TTTaiKhoan()"><i class="fas fa-user-alt"></i> Tài khoản</button>
                <button onclick="LogOut();"><i class="fas fa-sign-out-alt"></i> Đăng xuất</button>
            </div>
        </div>
    </section>
    <section class="main">
        <div class="row">
            <div class="col-1 col-s-12 category">
                <button onclick="TongQuan()"><i class="fas fa-tachometer-alt"></i> Tổng quan</button>
                <button onclick="LoaiSanPham()"><i class="fas fa-boxes"></i> Loại sản phẩm</button>
                <button onclick="SanPham()"><i class="fas fa-barcode"></i> Sản phẩm</button>
                <button onclick="NhaCungCap()"><i class="fas fa-truck"></i> Nhà cung cấp</button>
                <button onclick="KhachHang()"><i class="fas fa-users"></i> Khách hàng</button>
                <button onclick="NhanVien()"><i class="fas fa-user"></i> Nhân viên</button>
                <button class="active" onclick="HoaDonNhap()"><i class="fas fa-file-import"></i> Hóa đơn nhập</button>
                <button onclick="HoaDonBan()"><i class="fas fa-shopping-cart"></i> Hóa đơn bán</button>
                <button onclick="TinTuc()"><i class="fas fa-newspaper"></i> Tin tức</button>
                <button onclick="ThietLap()"><i class="fas fa-cogs"></i> Thiết lập</button>
            </div>
            <div class="bx-left" id="button-left">
                <a href="javascript:void(0)" class="closebtn" onclick="closeBTN()"><i
                        class="far fa-window-close"></i></a>
                <ul>
                    <li onclick="TongQuan()"><i class="fas fa-tachometer-alt"></i> Tổng quan</li>
                    <li onclick="LoaiSanPham()"><i class="fas fa-boxes"></i> Loại sản phẩm</li>
                    <li onclick="SanPham()"><i class="fas fa-barcode"></i> Sản phẩm</li>
                    <li onclick="NhaCungCap()"><i class="fas fa-truck"></i> Nhà cung cấp</li>
                    <li onclick="KhachHang()"><i class="fas fa-users"></i> Khách hàng</li>
                    <li onclick="NhanVien()"><i class="fas fa-user"></i> Nhân viên</li>
                    <li onclick="HoaDonNhap()"><i class="fas fa-file-import"></i> Hóa đơn nhập</li>
                    <li onclick="HoaDonBan()"><i class="fas fa-shopping-cart"></i> Hóa đơn bán</li>
                    <li onclick="TinTuc()"><i class="fas fa-newspaper"></i> Tin tức</li>
                    <li onclick="ThietLap()"><i class="fas fa-cogs"></i> Thiết lập</li>
                </ul>
            </div>
            <div class="col-11 col-s-12 content">
                <div class="col-6 col-s-12 content">
                    <div class="tabcontent">
                        <div class="title">
                            <i class="fas fa-file-import"></i> Nhập thông tin hóa đơn nhập
                            <hr>
                        </div>
                        <div class="row">
                            <form>
                                <div class="col-12 col-s-12 padding-box">
                                    <label for="txtright">Mã hóa đơn nhập:</label>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <input type="text" id="mahd"
                                        placeholder="Nhập mã hóa đơn...">
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <label for="txtright">Nhân viên:</label>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <select name="nhanvien" id="nhanviennhap">
                                        <option value="choose">--Chọn nhân viên--</option>
                                        <option value="Hoàng Thu Hậu">Hoàng Thu Hậu</option>
                                        <option value="Lê Văn Hà">Lê Văn Hà</option>
                                        <option value="Nguyễn Thị Hảo">Nguyễn Thị Hảo</option>
                                        <option value="Lê Xuân Dương">Lê Xuân Dương</option>
                                    </select>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <label for="txtright">Nhà cung cấp:</label>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <select name="nhacungcap" id="nhacungcap">
                                        <option value="choose">--Chọn nhà cung cấp--</option>
                                        <option value="Bùi Hoa">Bùi Hoa</option>
                                        <option value="Thúy Kiều">Thúy Kiều</option>
                                        <option value="Thúy Vân">Thúy Vân</option>
                                        <option value="Kim Trọng">Kim Trọng</option>
                                    </select>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <label for="txtright">Mã sản phẩm:</label>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <select name="loaisp" id="loaisp">
                                        <option value="choose">--Chọn sản phẩm--</option>
                                        <option value="Đồng hồ Rolex cơ">Đồng hồ Rolex cơ</option>
                                        <option value="Đồng hồ điện tử">Đồng hồ điện tử</option>
                                        <option value="Đồng hồ A S Max">Đồng hồ A S Max</option>
                                        <option value="Đồng hồ chống nước">Đồng hồ chống nước</option>
                                        <option value="Đồng hồ thợ lặn">Đồng hồ thợ lặn</option>
                                        <option value="Đồng hồ vận động viên">Đồng hồ vận động viên</option>
                                        <option value="Linh kiện đồng hồ">Linh kiện đồng hồ</option>
                                        <option value="Dây đồng hồ">Dây đồng hồ</option>
                                        <option value="Kim đồng hồ">Kim đồng hồ</option>
                                        <option value="Phụ tùng đồng hồ">Phụ tùng đồng hồ</option>
                                        <option value="Pin đồng hồ mini">Pin đồng hồ mini</option>
                                        <option value="Pin đồng hồ tròn">Pin đồng hồ tròn</option>
                                        <option value="Tai Nghe">Tai Nghe</option>
                                        <option value="Dây sạc">Dây sạc</option>
                                        
                                        <option value="Phụ Kiện Khác">Phụ Kiện Khác</option>
                                    </select>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <input type="number" id="tongsanpham" placeholder="Nhập số lượng...">
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <label for="txtright">Tổng tiền:</label>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <input type="number" id="tongtien" placeholder="Nhập tổng tiền...">
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <label for="txtright">Nhập hàng:</label>
                                </div>
                                <div class="col-12 col-s-12 padding-box">
                                    <textarea id="ghichu" cols="197" rows="4"
                                        placeholder="Nhập ghi chú nhập hàng ..."></textarea>
                                </div>
                            </form>
                        </div>
                        
                        <button class="btn-form" style="background-color: rgba(108, 125, 103, 0.8);"
                            onclick="ThemHoaDon()">Thêm hóa đơn nhập</button>
                        <button class="btn-form" style="background-color: rgba(227, 32, 21, 0.8);"
                            onclick="NhapMoi()">Nhập mới</button>
                    </div>
                </div>
                <div class="col-6 col-s-12 content">
                    <div class="tabcontent">
                        <div class="title">
                            <i class="fas fa-file-import"></i> Danh sách hóa đơn nhập
                            <button onclick="XoaChon()" style="margin-right: 3px;"><i class="far fa-trash-alt"></i> Xóa
                                chọn</button>
                            <hr>
                        </div>
                        <div class="row">
                            <div class="col-10 col-s-12 padding-box">
                                <input type="text" id="search-import" placeholder="Nhập mã hóa đơn nhập...">
                            </div>
                            <div class="col-2 col-s-12 padding-box">
                                <button><i class="fas fas fa-search"></i> Tìm kiếm</button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-s-12 padding-box">
                                <table>
                                    <thead>
                                        <tr>
                                            <th style="padding-top: 10px;"><input type="checkbox"
                                                    onclick="CheckAll(this)"></th>
                                            <th>Mã HDN</th>
                                            <th>Nhân viên</th>
                                            <th>Nhà cung cấp</th>
                                            <th>Sản phẩm</th>
                                            <th>Tổng tiền</th>
                                            <th>Ngày tạo</th>
                                            <th>Thao tác</th>
                                        </tr>
                                    </thead>
                                    <tbody id="listImport"></tbody>
                                    <!-- <tbody>
                                        <tr>
                                            <td style="text-align: center;padding-top: 10px;"><input type="checkbox"
                                                    value="" id=""></td>
                                            <td>111111</td>
                                            <td>Nguyễn Văn Anh</td>
                                            <td>Trần Anh</td>
                                            <td style="text-align: center;">20</td>
                                            <td style="text-align: right;">48900000</td>
                                            <td style="text-align: center;">03/06/2021 08:40:05</td>
                                            <td style="text-align: center;">
                                                <i class="fas fa-edit" title="Sửa"></i>
                                                <i class="fas fa-trash-alt" title="Xóa"></i>
                                            </td>
                                        </tr>
                                    </tbody> -->
                                </table>
                            </div>
                            <div class="col-12 col-s-12 padding-box">
                                <div class="box-sum">
                                    <div class="box-left">
                                        Số lượng hóa đơn: <span id="soluong">0</span>
                                        <br>
                                        Tổng tiền: <span id="tongtienhd">0</span><span>đ</span>
                                    </div>
                                    <div class="box-right">
                                        <button><i class="fas fa-angle-left"></i></button>
                                        <button>1</button>
                                        <button>2</button>
                                        <button>3</button>
                                        <button>4</button>
                                        <button><i class="fas fa-angle-right"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            // var user = JSON.parse(localStorage.getItem('user'));
            // if (!user) {
            //     window.location.href = "./admin/login.html";
            // }

            // LoadUser();

            // var sanpham = '<tr>\
            //             <td>\<input type="text" class="" placeholder="Mã sản phẩm...">\</td>\
            //             <td>\
            //                 <input type="text" class="" placeholder="Tên sản phẩm...">\
            //             </td>\
            //             <td>\
            //                 <input type="number" class="" placeholder="Số lượng...">\
            //             </td>\
            //             <td>\
            //                 <input type="number" class="" placeholder="Đơn giá...">\
            //             </td>\
            //             <td>\
            //                 <button class="" onclick="XoaSanPham(this)"><i class="fas fa-trash"></i></button>\
            //             </td>\
            //         </tr>';
            // $("#AddSanPham").click(function (e) {
            //     $("#DSSanPham").append(sanpham);
            // });

            var list = JSON.parse(localStorage.getItem('Import')) || [];

            function ThemHoaDon() {
                var mahd = document.getElementById("mahd").value;
                var nhanviennhap = document.getElementById("nhanviennhap").value;
                var nhacungcap = document.getElementById("nhacungcap").value;
                var loaisp = document.getElementById("loaisp").value;
                var tongtien = document.getElementById("tongtien").value;
                var ghichu = document.getElementById("ghichu").value;
                var ngaytao;
                var number = /^[0-9]+$/;

                if (mahd == null || mahd == "") {
                    var d = new Date();
                    mahd = Number(d);
                }
                else if (!mahd.match(number) || mahd.length != 2) {
                    alert("Mã hóa đơn phải là kiểu số và có độ dài là 02 ký tự! Vui lòng nhập lại!");
                    return false;
                }

                if (nhanviennhap == "choose") {
                    alert("Vui lòng chọn nhân viên!");
                    return false;
                }
                else if (nhacungcap == "choose") {
                    alert("Vui lòng chọn nhà cung cấp!");
                    return false;
                }
                if (loaisp == "choose") {
                    alert("Vui lòng chọn loại sản phẩm!");
                    return false;
                }
                else if (tongtien == null || tongtien == "") {
                    alert("Giá bán sản phẩm không được để trống! Vui lòng nhập lại!");
                    return false;
                } else if (tongtien <= 0) {
                    alert("Giá bán sản phẩm phải lớn hơn 0! Vui lòng nhập lại!");
                    return false;
                }
                else {
                    for (var x of list) {
                        if (x.mahd == mahd) {
                            alert("Mã hóa đơn đã tồn tại! Vui lòng nhập lại!")
                            return false;
                        }
                    }
                }

                var date = new Date().toLocaleDateString();
                var time = new Date().toLocaleTimeString();
                ngaytao = date + " " + time;

                console.log("AddImport");
                if (list == null) list = [];
                var imports = {
                    "mahd": mahd,
                    "nhanviennhap": nhanviennhap,
                    "nhacungcap": nhacungcap,
                    "loaisp": loaisp,
                    "tongtien": tongtien,
                    "ghichu": ghichu,
                    "ngaytao": ngaytao
                };
                list.push(imports);
                localStorage.setItem("Import", JSON.stringify(list));
                alert("Đã thêm thành công!");
                location.reload();
            }

            function NhapMoi() {
                document.getElementById('mahd').value = '';
                document.getElementById('nhanviennhap').value = 'choose';
                document.getElementById('nhacungcap').value = 'choose';
                document.getElementById('loaisp').value = 'choose';
                document.getElementById('tongtien').value = '';
                document.getElementById('ghichu').value = '';
                document.getElementById('ngaytao').value = '';
            }

            function LoadData() {
                var str = "";
                var sl = 0;
                var ttien = 0;
                list.sort();
                for (x of list) {
                    sl++;
                    ttien += Number(x.tongtien);
                    str += `<tr>
                        <td style="text-align: center;padding-top: 10px;"><input type="checkbox" name="check_all"></td>
                            <td>`+ x.mahd + `</td>
                            <td>`+ x.nhanviennhap + `</td>
                            <td>`+ x.nhacungcap + `</td>
                            <td style="text-align: center;">`+ x.loaisp + `</td>
                            <td style="text-align: right;">`+ x.tongtien + `</td>
                            <td style="text-align: center;">`+ x.ngaytao + `</td>
                            <td style="text-align: center;">
                                
                                <i class="fas fa-trash-alt" title="Xóa" onclick="XoaHoaDon(`+ x.mahd + `)"></i>
                            </td>
                        </tr>
                    `;
                }
                document.getElementById("listImport").innerHTML = str;
                $('#soluong').html(sl);
                $('#tongtienhd').html(ttien);
            }
            LoadData();

            function XoaHoaDon(mahd) {
                if (confirm("Bạn chắc chắn muốn xóa!")) {
                    var index = list.findIndex(x => x.mahd == mahd);
                    if (index >= 0) {
                        list.splice(index, 1);
                    }
                    LoadData();
                    localStorage.setItem('Import', JSON.stringify(list));
                }
            }

            function CheckAll(parent) {
                var ids = document.getElementsByTagName('input');
                for (var i = 0; i < ids.length; i++) {
                    if (ids[i].name == "check_all") {
                        ids[i].checked = parent.checked;
                    }
                }
            }
            // function SuaNhanVien(manv) {
            //     for (x of list) {
            //         if (x.manv == manv) {
            //             document.getElementById('mahd').value = x.mahd;
            //             document.getElementById('nhanviennhap').value = x.nhanviennhap;
            //             document.getElementById('nhacungcap').value = x.nhacungcap;
            //             document.getElementById('tongsanpham').value = x.tongsanpham;
            //             document.getElementById('tongtien').value = x.tongtien;
            //             document.getElementById('ghichu').value = x.ghichu;
            //             document.getElementById('ngaytao').value = x.ngaytao;
                        
                
            //         }
            //     }
            // }
            // function CapNhat() {
            //     var mahd = document.getElementById("mahd").value;
            //     var nhanviennhap = document.getElementById("nhanviennhap").value;
            //     var nhacungcap = document.getElementById("nhacungcap").value;
            //     var tongsanpham = document.getElementById("tongsanpham").value;
            //     var tongtien = document.getElementById("tongtien").value;
            //     var ghichu = document.getElementById("ghichu").value;
            //     var ngaytao;
            //     var number = /^[0-9]+$/;

            //     if (mahd == null || mahd == "") {
            //         var d = new Date();
            //         mahd = Number(d);
            //     }
            //     else if (!mahd.match(number) || mahd.length != 2) {
            //         alert("Mã hóa đơn phải là kiểu số và có độ dài là 02 ký tự! Vui lòng nhập lại!");
            //         return false;
            //     }

            //     if (nhanviennhap == "choose") {
            //         alert("Vui lòng chọn nhân viên!");
            //         return false;
            //     }
            //     else if (nhacungcap == "choose") {
            //         alert("Vui lòng chọn nhà cung cấp!");
            //         return false;
            //     }
            //     else if (tongsanpham == null || tongsanpham == "") {
            //         alert("Số lượng sản phẩm không được để trống! Vui lòng nhập lại!");
            //         return false;
            //     } else if (tongsanpham < 0) {
            //         alert("Số lượng sản phẩm phải lớn hơn hoặc bằng 0! Vui lòng nhập lại!");
            //         return false;
            //     }
            //     else if (tongtien == null || tongtien == "") {
            //         alert("Giá bán sản phẩm không được để trống! Vui lòng nhập lại!");
            //         return false;
            //     } else if (tongtien <= 0) {
            //         alert("Giá bán sản phẩm phải lớn hơn 0! Vui lòng nhập lại!");
            //         return false;
            //     }
            //     else {
            //         for (var x of list) {
            //             if (x.mahd == mahd) {
            //                 alert("Mã hóa đơn đã tồn tại! Vui lòng nhập lại!")
            //                 return false;
            //             }
            //         }
            //     }

            //     var date = new Date().toLocaleDateString();
            //     var time = new Date().toLocaleTimeString();
            //     ngaytao = date + " " + time;


            //     for (x of list) {
            //         if (x.mahd == mahd) {
            //             x.nhanviennhap = nhanviennhap;
            //             x.nhacungcap = nhacungcap;
            //             x.tongsanpham = tongsanpham;
            //             x.tongtien = tongtien;
            //             x.ghichu = ghichu;
            //             x.ngaytao = ngaytao;
                        
            //             ok = false;
            //             break;
                        
            //         }
            //     }
            //     if (ok == false) {
            //         alert("Cập nhật thông tin thành công!");
            //         localStorage.setItem("Staff", JSON.stringify(list));
            //         location.reload();
            //     }
            //     else {
            //         alert("Cập nhật thông tin thất bại!");
            //     }
            // }
        </script>
    </section>
</body>

</html>